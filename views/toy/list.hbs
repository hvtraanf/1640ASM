<body>
   <center>
      <h1>Toys List</h1>
      <br>
      <a class="btn paper-btn mb-3 mx-auto" href="/toy/add">Add new Toy</a>
      <a class="btn paper-btn mb-3 mx-auto" href="/brand/add">Add new Brand</a>
   </center>
   <center>
      <table class="table table-info" id="toyTable">
         <thead>
            <style>
               table {
                  border-collapse: separate;
                  border-spacing: 30px;
                  /* adjust this value to your liking */
               }
            </style>
            <tr>
               <th><a></a>Name</th>
               <th>Brand</th>
               <th>Price</th>
               <th>Quantity</th>
               <th>Image</th>
               <th>Action</th>
            </tr>
         </thead>
         <tbody>
            {{#each toyList }}
            <tr>
               <td>{{ name }}</td>
               <td>
                  <a href="/brand/detail/{{brand._id}}">
                     {{ brand.name }}
                  </a>
               </td>
               <td>${{ price }}</td>
               <td>{{ quantity }}</td>
               <td>
                  <a href="/toy/detail/{{_id}}">
                     <img src="{{imageUrl}}" width="100" height="100">
                  </a>
               </td>
               <td>
                  {{!-- {{#if isAdmin}} --}}
                  <a href="/toy/edit/{{ _id }}">Edit</a> |
                  <a href="/toy/delete/{{ _id }}">Delete</a> |
                  {{!-- {{/if}} --}}
                  <a href="/toy/addToCart/{{ _id }}">Buy</a>
               </td>
            </tr>
            {{/each}}
         </tbody>
      </table>
   </center>

   <script>
      var isAdmin = {{ isAdmin }};

      // Get all the headers
      var headers = document.querySelectorAll("th");

      // Initialize the sort order to 'asc' (ascending)
      var sortOrder = 'asc';

      // Loop through each header
      for (let i = 0; i < headers.length; i++) {
         // Add a click event listener to each header
         headers[i].addEventListener("click", function () {
            sortTable(i, sortOrder);
            // Toggle the sort order
            sortOrder = sortOrder === 'asc' ? 'desc' : 'asc';
         });
      }

      function sortTable(columnIndex, order) {
         var table = document.querySelector("table");
         var tbody = table.querySelector("tbody");

         // Clone the rows
         var rows = Array.from(tbody.querySelectorAll("tr")).map(row => row.cloneNode(true));

         // Sort the cloned rows
         rows.sort(function (rowA, rowB) {
            var cellA = rowA.cells[columnIndex].textContent;
            var cellB = rowB.cells[columnIndex].textContent;

            // Check if the values are numbers or strings
            var numA = Number(cellA);
            var numB = Number(cellB);
            var isNumber = !isNaN(numA) && !isNaN(numB);

            // Apply the appropriate comparison method
            if (isNumber) {
               return (numA - numB) * (order === 'asc' ? 1 : -1);
            } else {
               return cellA.localeCompare(cellB) * (order === 'asc' ? 1 : -1);
            }
         });

         // Remove existing rows from the table
         tbody.innerHTML = '';

         // Append the sorted rows to the table body
         rows.forEach(function (row) {
            tbody.appendChild(row);
         });
      }
   </script>
</body>
